---
title: ใช้ API กำหนดการโครงการกับ Power Automate
description: บทความนี้แสดงโฟลว์ตัวอย่างที่ใช้ Application Programming Interface (API) ของกำหนดการโครงการ
author: ruhercul
ms.date: 01/26/2022
ms.topic: article
ms.reviewer: johnmichalak
ms.author: ruhercul
ms.openlocfilehash: afec082c680596e8dcb8ec0b350b4bb7853c49ff
ms.sourcegitcommit: 7ed8e77a92917f2d242988ca02bd7de9571cce5e
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 09/02/2022
ms.locfileid: "9404411"
---
# <a name="use-project-schedule-apis-with-power-automate"></a>ใช้ API กำหนดการโครงการกับ Power Automate

_**นำไปใช้กับ:** Project Operations สำหรับสถานการณ์ตามทรัพยากร/ไม่ได้เก็บในคลัง การปรับใช้งานแบบ Lite - จัดการกับการออกใบแจ้งหนี้ชั่วคราว_

บทความนี้อธิบายโฟลว์ตัวอย่างที่แสดงวิธีสร้างแผนโครงการที่สมบูรณ์โดยใช้ Microsoft Power Automate วิธีสร้างชุดการดำเนินงาน และวิธีการปรับปรุงเอนทิตี ตัวอย่างนี้สาธิตวิธีการสร้างโครงการ สมาชิกทีมโครงการ ชุดปการดำเนินงาน งานโครงการ และการมอบหมายทรัพยากร บทความนี้ยังอธิบายวิธีปรับปรุงเอนทิตีและเรียกใช้ชุดการดำเนินงาน

ต่อไปนี้คือรายการขั้นตอนทั้งหมดที่บันทึกไว้ในโฟลว์ตัวอย่างในบทความนี้:

1. [สร้างทริกเกอร์ PowerApps](#1)
2. [สร้างโครงการ](#2)
3. [เริ่มต้นตัวแปรสำหรับสมาชิกทีม](#3)
4. [สร้างสมาชิกทีมทั่วไป](#4)
5. [สร้างชุดการดำเนินงาน](#5)
6. [สร้างบักเก็ตโครงการ](#6)
7. [เริ่มต้นตัวแปรสำหรับสถานะลิงก์](#7)
8. [เริ่มต้นตัวแปรสำหรับจำนวนของงาน](#8)
9. [เริ่มต้นตัวแปรสำหรับรหัสงานโครงการ](#9)
10. [ทำจนถึง](#10)
11. [ตั้งค่างานโครงการ](#11)
12. [สร้างงานโครงการ](#12)
13. [สร้างการมอบหมายทรัพยากร](#13)
14. [ลดตัวแปร](#14)
15. [เปลี่ยนชื่องานโครงการ](#15)
16. [เรียกใช้ชุดการดำเนินงาน](#16)

## <a name="assumptions"></a>สมมติฐาน

บทความนี้ถือว่าคุณมีความรู้พื้นฐานเกี่ยวกับแพลตฟอร์ม Dataverse, โฟลว์ระบบคลาวด์และ Application Programming Interface (API) ของกำหนดการโครงการ สำหรับข้อมูลเพิ่มเติม โปรดดู [ข้อมูลอ้างอิง](#references) ในภายหลังในบทความนี้

## <a name="create-a-flow"></a>สร้างโฟลว์

### <a name="select-an-environment"></a>เลือกสภาพแวดล้อม

คุณสามารถสร้างโฟลว์ Power Automate ในสภาพแวดล้อมของคุณ

1. ไปที่ <https://flow.microsoft.com> และใช้ข้อมูลประจำตัวของผู้ดูแลระบบของคุณเพื่อลงชื่อเข้าใช้
2. ในมุมขวาบน ให้เลือก **สภาพแวดล้อม**
3. ในรายการ ให้เลือกสภาพแวดล้อมที่ Dynamics 365 Project Operations ติดตั้งอยู่

### <a name="create-a-solution"></a>สร้างโซลูชัน

ทำตามขั้นตอนเหล่านี้เพื่อสร้าง [โฟลว์ที่สร้างในโซลูชัน](/power-automate/overview-solution-flows) ด้วยการสร้างโฟลว์ที่สร้างในโซลูชัน คุณสามารถส่งออกโฟลว์เพื่อใช้ในภายหลังได้ง่ายขึ้น

1. ในบานหน้าต่างนำทาง เลือก **โซลูชัน**
2. บนหน้า **โซลูชัน** ให้เลือก **โซลูชันใหม่**
3. ในกล่องโต้ตอบ **โซลูชันใหม่** ให้ตั้งค่าฟิลด์ต้องการ จากนั้น เลือก **สร้าง**

## <a name="step-1-create-a-powerapps-trigger"></a><a id="1"></a>ขั้นตอนที่ 1: สร้างทริกเกอร์ PowerApps

1. บนหน้า **โซลูชัน** เลือกโซลูชันที่คุณสร้าง แล้วเลือก **ใหม่**
2. ในบานหน้าต่างด้านซ้าย เลือก **โฟลว์ระบบคลาวด์** \> **ระบบอัตโนมัติ** \> **โฟลว์ระบบคลาวด์** \> **แบบทันที**
3. ในฟิลด์ **ชื่อโฟลว์** ให้ป้อน **โฟลว์สาธิตของ API กำหนดการ**
4. ในรายการ **เลือกวิธีทริกเกอร์โฟลว์นี้** ให้เลือก **Power Apps** เมื่อคุณสร้างทริกเกอร์ Power Apps ตรรกะจะขึ้นอยู่กับคุณในฐานะผู้สร้าง ในบทความนี้ ปล่อยพารามิเตอร์อินพุตเว้นว่างไว้เพื่อการทดสอบ
5. เลือก **สร้าง**

## <a name="step-2-create-a-project"></a><a id="2"></a>ขั้นตอนที่ 2: สร้างโครงการ

ทำตามขั้นตอนเหล่านี้เพื่อสร้างโครงการตัวอย่าง

1. ในโฟลว์ที่คุณสร้าง ให้เลือก **ขั้นตอนใหม่**

    ![การเพิ่มขั้นตอนใหม่](media/newstep.png)

2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **การดําเนินการที่ไม่ถูกผูก** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์

    ![การเลือกการดำเนินการ](media/chooseactiontab.png)

3. ในขั้นตอนใหม่ ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**

![การเปลี่ยนชื่อขั้นตอน](media/renamestep.png)

4. เปลี่ยนชื่อขั้นตอน **สร้างโครงการ**
5. ในฟิลด์ **ชื่อการดำเนินการ** ให้เลือก **msdyn\_CreateProjectV1**
6. ภายใต้ฟิลด์ **msdyn\_subject** ให้เลือก **เพิ่มเนื้อหาแบบไดนามิก**
7. บนแท็บ **นิพจน์** ในฟิลด์ฟังก์ชัน ให้ป้อน **ชื่อโครงการ - utcNow()**
8. เลือก **ตกลง**

## <a name="step-3-initialize-a-variable-for-the-team-member"></a><a id="3"></a>ขั้นตอนที่ 3: เริ่มต้นตัวแปรสำหรับสมาชิกทีม

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **เริ่มต้นตัวแปร** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอนใหม่ ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **เริ่มต้นสมาชิกทีม**
5. ในฟิลด์ **ชื่อ** ป้อน **TeamMemberAction**
6. ในฟิลด์ **ชนิด** เลือก **สตริง**
7. ในฟิลด์ **ค่า** ให้ป้อน **msdyn\_CreateTeamMemberV1**

## <a name="step-4-create-a-generic-team-member"></a><a id="4"></a>ขั้นตอนที่ 4: สร้างสมาชิกทีมโครงการทั่วไป

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **การดําเนินการที่ไม่ถูกผูก** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอนใหม่ ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **สร้างสมาชิกทีม**
5. สำหรับฟิลด์ **ชื่อการดำเนินการ** ให้เลือก **TeamMemberAction** ในกล่องโต้ตอบ **เนื้อหาแบบไดนามิก**
6. ในฟิลด์ **พารามิเตอร์การดำเนินการ** ให้ป้อนข้อมูลพารามิเตอร์ต่อไปนี้

    ```
    {
        "TeamMember": {
            "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projectteam",
            "msdyn_projectteamid": "@{guid()}",
            "msdyn_project@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})",
            "msdyn_name": "ScheduleAPIDemoTM1"
        }
    } 
    ```

    ต่อไปนี้เป็นคำอธิบายของพารามิเตอร์:

    - **\@\@odata.type** – ชื่อเอนทิตี ตัวอย่างเช่น ให้ป้อน **"Microsoft.Dynamics.CRM.msdyn\_projectteam"**
    - **msdyn\_projectteamid** – คีย์หลักของรหัสทีมโครงการ ค่านี้เป็นนิพจน์รหัสเฉพาะสากล (GUID)   รหัสดังกล่าวสร้างขึ้นจากแท็บนิพจน์

    - **msdyn\_project\@odata.bind** – รหัสโครงการของโครงการที่เป็นเจ้าของ ค่านี้จะเป็นเนื้อหาแบบไดนามิกที่มาจากการตอบสนองของขั้นตอน "สร้างโครงการ" ตรวจสอบให้แน่ใจว่าคุณป้อนพาธแบบเต็มและเพิ่มเนื้อหาแบบไดนามิกระหว่างวงเล็บ ต้องมีเครื่องหมายอัญประกาศ ตัวอย่างเช่น ป้อน **"/msdyn\_projects(ADD DYNAMIC CONTENT)"**
    - **msdyn\_name** – ชื่อของสมาชิกทีม ตัวอย่างเช่น ป้อน **"ScheduleAPIDemoTM1"**

## <a name="step-5-create-an-operation-set"></a><a id="5"></a>ขั้นตอนที่ 5: สร้างชุดการดำเนินงาน

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **การดําเนินการที่ไม่ถูกผูก** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอนใหม่ ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **สร้างชุดการดำเนินงาน**
5. ในฟิลด์ **ชื่อการดำเนินการ** ให้เลือก **msdyn\_CreateOperationSetV1** ของการดำเนินการที่กำหนดเองของ Dataverse
6. ในฟิลด์ **คำอธิบาย** ให้ป้อน **ScheduleAPIDemoOperationSet**
7. ในฟิลด์ **โครงการ** ให้ป้อน **/msdyn\_projects(**
8. ในกล่องโต้ตอบ **เนื้อหาแบบไดนามิก** ให้เลือก **msdyn\_CreateProjectV1Response ProjectId**
9. ในฟิลด์ **โครงการ** ให้ป้อน **)**

## <a name="step-6-create-a-project-bucket"></a><a id="6"></a>ขั้นตอนที่ 6: สร้างบักเก็ตโครงการ

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **เพิ่มแถวใหม่** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอนใหม่ ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **สร้างบักเก็ต**
5. ในฟิลด์ **ชื่อตาราง** ให้เลือก **บักเก็ตโครงการ**
6. ในฟิลด์ **ชื่อ** ป้อน **ScheduleAPIDemoBucket1**
7. สำหรับฟิลด์ **โครงการ** ให้เลือก **msdyn\_CreateProjectV1Response ProjectId** ในกล่องโต้ตอบ **เนื้อหาแบบไดนามิก**

## <a name="step-7-initialize-a-variable-for-the-link-status"></a><a id="7"></a>ขั้นตอนที่ 7: เริ่มต้นตัวแปรสำหรับสถานะลิงก์

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **เริ่มต้นตัวแปร** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอนใหม่ ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **เริ่มต้นสถานะลิงก์**
5. ในฟิลด์ **ชื่อ** ป้อน **linkstatus**
6. ในฟิลด์ **ชนิด** เลือก **จำนวนเต็ม**
7. ในฟิลด์ **ค่า** ให้ป้อน **192350000**

## <a name="step-8-initialize-a-variable-for-the-number-of-tasks"></a><a id="8"></a>ขั้นตอนที่ 8: เริ่มต้นตัวแปรสำหรับจำนวนของงาน

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **เริ่มต้นตัวแปร** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอนใหม่ ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **เริ่มต้นจำนวนของงาน**
5. ในฟิลด์ **ชื่อ** ให้ป้อน **จำนวนของงาน**
6. ในฟิลด์ **ชนิด** เลือก **จำนวนเต็ม**
7. ในฟิลด์ **ค่า** ให้ป้อน **5**

## <a name="step-9-initialize-a-variable-for-the-project-task-id"></a><a id="9"></a>ขั้นตอนที่ 9: เริ่มต้นตัวแปรสำหรับรหัสงานโครงการ

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **เริ่มต้นตัวแปร** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอนใหม่ ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **เริ่มต้น ProjectTaskID**
5. ในฟิลด์ **ชื่อ** ให้ป้อน **จำนวนของงาน**
6. ในฟิลด์ **ชนิด** เลือก **สตริง**
7. สำหรับฟิลด์ **ค่า** ให้ป้อน **guid()** ในตัวสร้างนิพจน์

## <a name="step-10-do-until"></a><a id="10"></a>ขั้นตอนที่ 10: ทำจนถึง

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **ทำจนถึง** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ตั้งค่าแรกในคำสั่งเงื่อนไขเป็นตัวแปร **จำนวนของงาน** จากกล่องโต้ตอบ **เนื้อหาแบบไดนามิก**
4. ตั้งค่าเงื่อนไขเป็น **น้อยกว่าหรือเท่ากับ**
5. ตั้งค่าที่สองในคำสั่งเงื่อนไขเป็น **0**

## <a name="step-11-set-a-project-task"></a><a id="11"></a>ขั้นตอนที่ 11: ตั้งค่างานโครงการ

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **ตั้งค่าตัวแปร** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอนใหม่ ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **ตั้งค่างานโครงการ**
5. ในฟิลด์ **ชื่อ** ให้เลือก **msdyn\_projecttaskid**
6. สำหรับฟิลด์ **ค่า** ให้ป้อน **guid()** ในตัวสร้างนิพจน์

## <a name="step-12-create-a-project-task"></a><a id="12"></a>ขั้นตอนที่ 12: สร้างงานโครงการ

ทำตามขั้นตอนเหล่านี้เพื่อสร้างงานโครงการที่มีรหัสเฉพาะที่เป็นของโครงการปัจจุบันและบักเก็ตโครงการที่คุณสร้างขึ้น

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **การดําเนินการที่ไม่ถูกผูก** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอน ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **สร้างงานโครงการ**
5. ในฟิลด์ **ชื่อการดำเนินการ** ให้เลือก **msdyn\_PssCreateV1**
6. ในฟิลด์ **เอนทิตี** ให้ป้อนข้อมูลพารามิเตอร์ต่อไปนี้

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projecttask",
        "msdyn_projecttaskid": "@{variables('msdyn_projecttaskid')}",
        "msdyn_project@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})",
        "msdyn_subject": "ScheduleAPIDemoTask1",
        "msdyn_projectbucket@odata.bind": "/msdyn_projectbuckets(@{outputs('Create_Project_Buckets')?['body/msdyn_projectbucketid']})",
        "msdyn_start": "@{addDays(utcNow(), 1)}",
        "msdyn_scheduledstart": "@{utcNow()}",
        "msdyn_scheduledend": "@{addDays(utcNow(), 5)}",
        "msdyn_LinkStatus": "192350000"
    }
    ```

    ต่อไปนี้เป็นคำอธิบายของพารามิเตอร์:

    - **\@\@odata.type** – ชื่อเอนทิตี ตัวอย่างเช่น ให้ป้อน **"Microsoft.Dynamics.CRM.msdyn\_projecttask"**
    - **msdyn\_projecttaskid** – รหัสเฉพาะของงาน ค่าควรมีการตั้งค่าเป็นตัวแปรแบบไดนามิกจาก **msdyn\_projecttaskid**
    - **msdyn\_project\@odata.bind** – รหัสโครงการของโครงการที่เป็นเจ้าของ ค่านี้จะเป็นเนื้อหาแบบไดนามิกที่มาจากการตอบสนองของขั้นตอน "สร้างโครงการ" ตรวจสอบให้แน่ใจว่าคุณป้อนพาธแบบเต็มและเพิ่มเนื้อหาแบบไดนามิกระหว่างวงเล็บ ต้องมีเครื่องหมายอัญประกาศ ตัวอย่างเช่น ป้อน **"/msdyn\_projects(ADD DYNAMIC CONTENT)"**
    - **msdyn\_subject** – ชื่องานใดๆ
    - **msdyn\_projectbucket\@odata.bind** – บักเก็ตโครงการที่มีงานต่างๆ ค่านี้จะเป็นเนื้อหาแบบไดนามิกที่มาจากการตอบสนองของขั้นตอน "สร้างบักเก็ต" ตรวจสอบให้แน่ใจว่าคุณป้อนพาธแบบเต็มและเพิ่มเนื้อหาแบบไดนามิกระหว่างวงเล็บ ต้องมีเครื่องหมายอัญประกาศ ตัวอย่างเช่น ป้อน **"/msdyn\_projectbuckets(ADD DYNAMIC CONTENT)"**
    - **msdyn\_start** – เนื้อหาแบบไดนามิกสำหรับวันที่เริ่มต้น ตัวอย่างเช่น วันพรุ่งนี้จะแสดงเป็น **"addDays(utcNow(), 1)"**
    - **msdyn\_scheduledstart** – วันที่เริ่มต้นตามกำหนดการ ตัวอย่างเช่น วันพรุ่งนี้จะแสดงเป็น **"addDays(utcNow(), 1)"**
    - **msdyn\_scheduleend** – วันที่สิ้นสุดตามกำหนดการ เลือกวันที่ในอนาคต ตัวอย่างเช่น ให้ระบุ **"addDays(utcNow(), 5)"**
    - **msdyn\_LinkStatus** – สถานะลิงก์ ตัวอย่างเช่น ป้อน **"192350000"**

7. สำหรับฟิลด์ **OperationSetId** ให้เลือก **msdyn\_CreateOperationSetV1Response** ในกล่องโต้ตอบ **เนื้อหาแบบไดนามิก**

## <a name="step-13-create-a-resource-assignment"></a><a id="13"></a>ขั้นตอนที่ 13: สร้างการมอบหมายทรัพยากร

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **การดําเนินการที่ไม่ถูกผูก** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอน ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **สร้างการมอบหมาย**
5. ในฟิลด์ **ชื่อการดำเนินการ** ให้เลือก **msdyn\_PssCreateV1**
6. ในฟิลด์ **เอนทิตี** ให้ป้อนข้อมูลพารามิเตอร์ต่อไปนี้

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_resourceassignment",
        "msdyn_resourceassignmentid": "@{guid()}",
        "msdyn_name": "ScheduleAPIDemoAssign1",
        "msdyn_taskid@odata.bind": "/msdyn_projecttasks(@{variables('msdyn_projecttaskid')})",
        "msdyn_projectteamid@odata.bind": "/msdyn_projectteams(@{outputs('Create_Team_Member')?['body/TeamMemberId']})",
        "msdyn_projectid@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})"
    }
    ```

7. สำหรับฟิลด์ **OperationSetId** ให้เลือก **msdyn\_CreateOperationSetV1Response** ในกล่องโต้ตอบ **เนื้อหาแบบไดนามิก**

## <a name="step-14-decrement-a-variable"></a><a id="14"></a>ขั้นตอนที่ 14: ลดตัวแปร

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **ลดตัวแปร** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในฟิลด์ **ชื่อ** ให้เลือก **จำนวนของงาน**
4. ในฟิลด์ **ค่า** ให้ป้อน **1**

## <a name="step-15-rename-a-project-task"></a><a id="15"></a>ขั้นตอนที่ 15: เปลี่ยนชื่องานโครงการ

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **การดําเนินการที่ไม่ถูกผูก** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอน ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **เปลี่ยนชื่องานโครงการ**
5. ในฟิลด์ **ชื่อการดำเนินการ** ให้เลือก **msdyn\_PssUpdateV1**
6. ในฟิลด์ **เอนทิตี** ให้ป้อนข้อมูลพารามิเตอร์ต่อไปนี้

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projecttask",
        "msdyn_projecttaskid": "@{variables('msdyn_projecttaskid')}",
        "msdyn_subject": "ScheduleDemoTask1-UpdatedName"
    }
    ```

7. สำหรับฟิลด์ **OperationSetId** ให้เลือก **msdyn\_CreateOperationSetV1Response** ในกล่องโต้ตอบ **เนื้อหาแบบไดนามิก**

## <a name="step-16-run-an-operation-set"></a><a id="16"></a>ขั้นตอนที่ 16: เรียกใช้ชุดการดำเนินงาน

1. ในโฟลว์ ให้เลือก **ขั้นตอนใหม่**
2. ในกล่องโต้ตอบ **เลือกการดำเนินการ** ในฟิลด์ค้นหา ให้ป้อน **การดําเนินการที่ไม่ถูกผูก** จากนั้นบนแท็บ **การดำเนินการ** เลือกการดำเนินการในรายการผลลัพธ์
3. ในขั้นตอน ให้เลือกจุดไข่ปลา (**...**) แล้วเลือก **เปลี่ยนชื่อ**
4. เปลี่ยนชื่อขั้นตอน **ประมวลผลชุดการดำเนินงาน**
5. ในฟิลด์ **ชื่อการดำเนินการ** ให้เลือก **msdyn\_ExecuteOperationSetV1**
6. สำหรับฟิลด์ **OperationSetId** ให้เลือก **msdyn\_CreateOperationSetV1Response OperationSetId** ในกล่องโต้ตอบ **เนื้อหาแบบไดนามิก**

## <a name="references"></a>การอ้างอิง

- [ภาพรวมของวิธีการรวมโฟลว์กับ Dataverse - Power Automate](/power-automate/dataverse/overview?WT.mc_id=email)
- [ใช้ API กำหนดการโครงการเพื่อดำเนินการกับเอนทิตีการจัดกำหนดการ](schedule-api-preview.md)
- [ภาพรวมของโฟลว์ระบบคลาวด์ - Power Automate](/power-automate/overview-cloud?WT.mc_id=email)
- [ภาพรวมของโฟลว์ที่สร้างในโซลูชัน - Power Automate](/power-automate/overview-solution-flows?WT.mc_id=email)
